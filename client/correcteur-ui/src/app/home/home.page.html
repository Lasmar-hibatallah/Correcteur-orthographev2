<ion-content [fullscreen]="true" class="main-content">
  <div class="background-blobs">
    <div class="blob blob-1"></div>
    <div class="blob blob-2"></div>
  </div>

  <div class="container">
    <header class="hero ion-text-center">
      <h1 class="gradient-text">TextMind</h1>
      <p>Correction intelligente </p>
    </header>

    <div class="glass-card editor-container">
      <div class="card-header">
        <ion-icon name="document-text-outline"></ion-icon>
        <span>Texte à analyser</span>
      </div>
      
      <ion-textarea
        [(ngModel)]="text"
        placeholder="Entrez votre texte ici..."
        [autoGrow]="true"
        rows="5"
        class="custom-textarea">
      </ion-textarea>

      <ion-button expand="block" (click)="correctText()" [disabled]="isLoading" class="btn-correct">
        @if (isLoading) {
          <ion-spinner name="crescent"></ion-spinner>
        } @else {
          <ion-icon name="sparkles" slot="start"></ion-icon>
          Lancer la correction
        }
      </ion-button>
    </div>

    @if (result) {
      <div class="animate__animated animate__fadeIn">
        
        <div class="stats-row">
          <div class="stat-item"><strong>{{result.stats.total}}</strong> fautes</div>
          <div class="stat-item"><strong>{{result.stats.words}}</strong> mots</div>
        </div>

        <div class="glass-card success-card">
          <div class="card-header">
            <ion-icon name="checkmark-circle" color="success"></ion-icon>
            <span>Texte suggéré</span>
          </div>
          <p class="corrected-preview">{{ result.correctedText }}</p>
        </div>

        <h3 class="section-title">Détails des erreurs</h3>
        @for (issue of result.issues; track $index) {
          <div class="glass-card error-card" [ngClass]="issue.type">
            <div class="error-header">
              <span class="type-badge">{{ issue.type }}</span>
              <span class="excerpt">"{{ issue.excerpt }}"</span>
            </div>
            <p class="error-msg">{{ issue.message }}</p>
            @if (issue.suggestion) {
              <div class="suggestion-box">
                <ion-icon name="sparkles" color="secondary"></ion-icon>
                <span>Correction : <strong>{{ issue.suggestion }}</strong></span>
              </div>
            }
          </div>
        }
      </div>
    }
  </div>
</ion-content>